SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO




CREATE VIEW [MERGEPROCESS_New].[vw_Cust_Account_ColumnLogic]
AS

SELECT mrg.Winning_ID AS ID 
	  ,mrg.Losing_ID AS Losing_ID 																		
	  ,/*OwnerId			- Standard							*/	COALESCE(winner.OwnerId,loser.OwnerId)																														 AS [OwnerId]
	  ,/*PhotoUrl			- Standard							*/	COALESCE(winner.PhotoUrl,loser.PhotoUrl)																													 AS [PhotoUrl]
	  ,/*CreatedDate		- Earliest from both records		*/	CASE WHEN CAST(winner.CreatedDate as DATE) < CAST(loser.CreatedDate as DATE) THEN CAST(loser.CreatedDate as DATE) ELSE CAST(winner.CreatedDate as DATE) END	 AS [CreatedDate]
	  ,/*copyloaddate		- Most recent from both records		*/	CASE WHEN winner.copyloaddate < loser.copyloaddate THEN loser.copyloaddate ELSE winner.copyloaddate END														 AS [copyloaddate]
	  ,/*LastModifiedDate	- Most recent from both records		*/	CASE WHEN winner.LastModifiedDate < loser.LastModifiedDate THEN loser.LastModifiedDate ELSE winner.LastModifiedDate END										 AS [LastModifiedDate]
	  ,/*SystemModstamp		- Most recent from both records		*/	CASE WHEN winner.SystemModstamp < loser.SystemModstamp THEN loser.SystemModstamp ELSE winner.SystemModstamp END												 AS [SystemModstamp]
	  ,/*CreatedById		- custom							*/	CASE WHEN CAST(winner.CreatedDate as DATE) < CAST(loser.CreatedDate as DATE) THEN loser.CreatedById ELSE winner.CreatedById END								 AS [CreatedById]
	  ,/*LastModifiedById	- custom							*/	CASE WHEN winner.LastModifiedDate < loser.LastModifiedDate THEN loser.LastModifiedById ELSE winner.LastModifiedById END										 AS [LastModifiedById]
FROM [MERGEPROCESS_New].[Queue] mrg
	JOIN MERGEPROCESS_New.tmp_pccontact winner ON winner.id = mrg.Winning_ID
	JOIN MERGEPROCESS_New.tmp_pccontact loser ON loser.id = mrg.Losing_ID
 WHERE mrg.ObjectType = 'Account'
















































































































































































































































































































































 






 
 



   
    
      











  

  
       
     




    



 



       
        
          









  











    





    







   













 
 
 

       
       


  
  




     
     


     
     


       
       

   
   






     
           
         

 




    





















GO
